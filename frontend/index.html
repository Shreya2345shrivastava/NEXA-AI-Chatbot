<!DOCTYPE html>
<html>
<head>
  <title>NEXA AI Chatbot</title>
</head>
<body>

  <h2>AI Chatbot</h2>

  <input id="msg" placeholder="Type or speak..." />
  <button onclick="send()">Send</button>
  <button onclick="startVoice()">ðŸŽ¤ Speak</button>

  <p id="reply"></p>

  <script>
    async function send(textFromVoice = null) {
      const message =
        textFromVoice || document.getElementById("msg").value;

      if (!message) return;

      const res = await fetch("http://localhost:5000/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message })
      });

      const data = await res.json();
      document.getElementById("reply").innerText = data.reply;

      speak(data.reply);
    }

    function startVoice() {
      const SpeechRecognition =
        window.SpeechRecognition || window.webkitSpeechRecognition;

      if (!SpeechRecognition) {
        alert("Speech Recognition not supported in this browser.");
        return;
      }

      const recognition = new SpeechRecognition();
      recognition.lang = "en-US";
      recognition.start();

      recognition.onresult = function (event) {
        const spokenText = event.results[0][0].transcript;
        document.getElementById("msg").value = spokenText;
        send(spokenText);
      };
    }

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = "en-US";
      window.speechSynthesis.speak(utterance);
    }
  </script>

</body>
</html>
